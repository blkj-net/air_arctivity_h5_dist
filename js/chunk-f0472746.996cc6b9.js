(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f0472746"],{"2ed8":function(t,e,a){},"34c3":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("title-bar",{attrs:{title:"西部航空-渝悦飞",fixed:"","go-back":"",shadow:""}}),a("div",{staticClass:"main"},[a("div",{staticClass:"m_30"},[a("div",{staticClass:"traveller"},[a("van-row",{staticClass:"bg_title",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{staticClass:"title",attrs:{span:12}},[a("span",[t._v(" 旅客信息")]),a("span",{staticClass:"sub_title"},[t._v("快速添加信息")])]),a("van-col",{staticClass:"t-r",attrs:{span:12}},[a("van-button",{staticClass:"btn_primary btn_add",attrs:{type:"info"},on:{click:t.handleTravelAddClick}},[t._v("新增")])],1)],1),t.travellerList.length<=0?a("div",[a("van-empty",{attrs:{description:"暂无数据"}})],1):a("div",[t._l(t.travellerList,(function(e,s){return[a("van-swipe-cell",{attrs:{"stop-propagation":!0},scopedSlots:t._u([{key:"right",fn:function(){return[a("van-button",{attrs:{square:"",type:"danger",text:"删除"},on:{click:function(e){return t.handleTravellerDel(s)}}})]},proxy:!0}],null,!0)},[a("van-row",{key:s,attrs:{type:"flex"}},[a("van-col",{staticClass:"traveller_l",attrs:{span:10}},[a("span",[t._v(t._s(e.username))])]),a("van-col",{staticClass:"traveller_r",attrs:{span:14}},[a("div",[t._v("身份证："+t._s(e.idcard_no))]),a("div",[t._v("电话："+t._s(e.phone))]),a("div")])],1),a("div",{staticClass:"traveller_border"})],1)]}))],2),a("div")],1),a("div",{staticClass:"contacts"},[a("van-row",{staticClass:"bg_title",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{staticClass:"title",attrs:{span:24}},[t._v(" 联系人 ")])],1),a("van-row",{attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{attrs:{span:24}},[a("van-form",{ref:"contactForm"},[a("van-field",{attrs:{name:"姓名",label:"姓名",placeholder:"姓名",rules:[{required:!0,message:"请填写姓名"},{pattern:/^[\u4E00-\u9FA5A-Za-z][\u4E00-\u9FA5A-Za-z\s\.]+$/,message:"姓名格式错误"}]},model:{value:t.contactInfo.username,callback:function(e){t.$set(t.contactInfo,"username",e)},expression:"contactInfo.username"}}),a("van-field",{attrs:{name:"身份证",label:"身份证",placeholder:"身份证",rules:[{required:!0,message:"请填写身份证"},{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"证件号格式不对"}]},model:{value:t.contactInfo.idcard_no,callback:function(e){t.$set(t.contactInfo,"idcard_no",e)},expression:"contactInfo.idcard_no"}}),a("van-field",{attrs:{name:"手机号",label:"手机号",placeholder:"手机号",rules:[{required:!0,message:"请填写手机号"},{pattern:/^[1][0-9]{10}$/,message:"手机号格式不对"}]},model:{value:t.contactInfo.phone,callback:function(e){t.$set(t.contactInfo,"phone",e)},expression:"contactInfo.phone"}})],1)],1)],1)],1),a("div",{staticClass:"order_info"},[a("van-row",{staticClass:"title"},[t._v("订单信息")]),a("van-row",{staticClass:"date"},[t._v(t._s(t.moment(t.startTime).format("YYYY-MM-DD"))+"\n          "+t._s(t._f("formatWeek")(t.schedule))+"\n          "+t._s(t.moment(t.startTime).format("HH:mm"))+" 起飞("+t._s(t.startCity)+"-"+t._s(t.endCity)+")")]),a("van-row",{staticClass:"title"},[t._v("核对价格")]),a("van-row",{staticClass:"content",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("div",[t._v("机酒套餐")]),a("div",{staticClass:"line"}),a("div",[t._v("￥"+t._s(t.hotel_price+t.price)+" x"+t._s(t.travellerList.length)+"人")])]),a("van-row",{staticClass:"desc"},[t._v("包含机票酒店费用")]),a("van-row",{staticClass:"cost",attrs:{type:"flex",justify:"end",align:"center"}},[a("div",{staticClass:"text"},[t._v("支付总价:")]),a("div",{staticClass:"icon"},[t._v("¥")]),a("div",{staticClass:"fee"},[t._v("\n            "+t._s((t.hotel_price+t.price)*t.travellerList.length)+"\n          ")])]),a("van-row",{staticClass:"total",attrs:{type:"flex",justify:"end",align:"center"}},[a("div",[t._v(t._s(t.travellerList.length)+"人")])])],1),a("div",[a("van-button",{staticClass:"btn_primary btn_submit",attrs:{block:"",type:"info",disabled:t.submiting},on:{click:t.handleSubmit}},[t._v("提交订单")])],1),a("div",{staticClass:"attion"},[t._v("【注意事项】")]),a("div",{staticClass:"attion"},[t._v("\n        西部航空为您提供更低价格的纯机票服务和更自由的附加服务，请阅知以下差异化服务标准：\n      ")]),a("div",{staticClass:"attion"},[t._v("\n        西部航空不提供免费机上餐饮服务（商务经济舱CD舱除外），免费托运行李额低，部分票价无免费托运行李额。\n      ")]),a("div",{staticClass:"attion"},[t._v("\n        西部航空航班若发生不正常，国内航班可免费变更至西部航空前后7天，春运、国庆时段为前后3天航班。航班取消，航班出港、到港时间推迟15分钟（不含）以上和航班出港时间提前的航班可申请非自愿退票，免退票手续费，无经济赔偿。\n      ")]),a("div",{staticClass:"attion"},[t._v("购票前可先点击阅读西部航空客票相关规定：")]),a("a",{staticClass:"biaoqiana",attrs:{href:"https://www.westair.cn/stcontent/menupage/fe61b2ec-9adb-4033-9d00-3297748aa1cc/1d59648d-9ea4-471b-bffc-f516589f5f3b/5a194449-1343-4b8b-8d08-12e474043223"}},[t._v("西部航空国内运输总条件")]),a("br"),a("a",{staticClass:"biaoqiana",attrs:{href:"https://www.westair.cn/stcontent/menupage/fe61b2ec-9adb-4033-9d00-3297748aa1cc/1d59648d-9ea4-471b-bffc-f516589f5f3b/4b67c27d-e536-4230-9288-50bb0301347a"}},[t._v("西部航空国际运输总条件")]),a("br"),a("a",{staticClass:"biaoqiana",attrs:{href:"https://www.westair.cn/stcontent/menupage/fe61b2ec-9adb-4033-9d00-3297748aa1cc/1d59648d-9ea4-471b-bffc-f516589f5f3b/92442ca4-6a45-45a0-b927-6cfe33f085a9"}},[t._v("西部航空乘客告知书")]),a("br"),a("a",{staticClass:"biaoqiana",attrs:{href:"https://www.westair.cn/stcontent/menupage/978be190-8fb7-46e4-9f68-76188ed9a933/28ff5df5-4798-4b3f-a06b-e663a5346118/c3173d37-505f-4e06-9351-29f21e8082e3"}},[t._v("西部航空不正常航班服务")])])]),a("van-popup",{style:{height:"50%"},attrs:{closeable:"","close-icon":"close",position:"bottom"},model:{value:t.flightListShow,callback:function(e){t.flightListShow=e},expression:"flightListShow"}},[a("div",{staticClass:"flist"},[t._l(t.flightList,(function(e,s){return[a("div",{key:s,staticClass:"fitem",on:{click:function(a){return t.handleFlightItemClick(e)}}},[a("div",{staticClass:"fitem_content"},[a("van-row",{attrs:{type:"flex",justify:"space-between",align:"center"}},[a("span",{},[a("img",{staticClass:"fitem_logo"})]),a("span",{staticClass:"fitem_name"},[t._v("西部航空")]),a("span",{staticClass:"fitem_flight_name"},[t._v(t._s(e.flightName))]),a("span",{staticClass:"fitem_date"},[t._v(t._s(t.moment(t.currentItem.date).format("MM-DD")))]),a("span",{staticClass:"fitem_week"},[t._v(t._s(t._f("formatWeek")(t.currentItem.week)))])]),a("van-row",{staticClass:"fitem_row2",attrs:{type:"flex",align:"bottom",justify:"space-between"}},[a("div",[a("div",{staticClass:"fitem_time"},[t._v("\n                  "+t._s(t.moment(e.startTime).format("HH:mm"))+"\n                ")]),a("div",{staticClass:"fitem_city"},[t._v(t._s(e.startCity))])]),a("div",[a("div",{staticClass:"fitem_hours"},[t._v(t._s(e.diffTime))]),a("div",{staticClass:"fitem_arrow"},[a("img",{staticClass:"fitem_arrow_img"})])]),a("div",[a("div",{staticClass:"fitem_time"},[t._v("\n                  "+t._s(t.moment(e.endTime).format("HH:mm"))+"\n                ")]),a("div",{staticClass:"fitem_city"},[t._v(t._s(e.endCity))])])]),a("van-row",{staticClass:"fitem_row3",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.bookingStock<=5,expression:"item.bookingStock <= 5"}]},[a("span",{staticClass:"fitem_residue_text"},[t._v("剩余数量：")]),a("span",{staticClass:"fitem_residue_num"},[t._v(t._s(e.bookingStock))])])]),a("div",[a("span",{staticClass:"fitem_flight_total_title"},[t._v("机酒总价")]),a("span",{staticClass:"fitem_price_ico"},[t._v("¥")]),a("span",{staticClass:"fitem_price"},[t._v(t._s(t._f("numFormat")(e.price)))])])])],1),a("div",{staticClass:"fitem_line"})])]}))],2)]),a("van-popup",{style:{height:"100%"},attrs:{position:"bottom"},model:{value:t.hotelShow,callback:function(e){t.hotelShow=e},expression:"hotelShow"}},[t.hotelInfo.details?a("div",[a("van-nav-bar",{attrs:{title:"酒店详情","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),a("div",{staticClass:"hotel_modal"},[a("van-row",{staticClass:"bg_title",staticStyle:{"margin-top":"0"},attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{staticClass:"title",attrs:{span:24}},[a("span",[t._v("酒店信息")])])],1),a("div",{domProps:{innerHTML:t._s(t.hotelInfo.details.info)}}),a("van-row",{staticClass:"bg_title",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("van-col",{staticClass:"title",attrs:{span:24}},[a("span",[t._v("注意事项")])])],1),a("div",t._l(t.hotelInfo.details.notice,(function(e,s){return a("div",{key:s},[a("div",[a("span",[a("img",{staticClass:"notice_img"})]),a("span",[t._v(t._s(e))])])])})),0)],1)],1):t._e()]),a("van-popup",{style:{height:"100%"},attrs:{position:"bottom"},model:{value:t.travelShow,callback:function(e){t.travelShow=e},expression:"travelShow"}},[a("div",[a("van-nav-bar",{attrs:{title:"新增旅客","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),a("van-form",{on:{submit:t.handleTravelSubmit}},[a("van-field",{attrs:{name:"姓名",label:"姓名",placeholder:"姓名",rules:[{required:!0,message:"请填写姓名"},{pattern:/^[\u4E00-\u9FA5A-Za-z][\u4E00-\u9FA5A-Za-z\s\.]+$/,message:"姓名格式错误"}]},model:{value:t.formModel.username,callback:function(e){t.$set(t.formModel,"username",e)},expression:"formModel.username"}}),a("van-field",{attrs:{name:"身份证",label:"身份证",placeholder:"身份证",rules:[{required:!0,message:"请填写身份证"},{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"证件号格式不对"}]},model:{value:t.formModel.idcard_no,callback:function(e){t.$set(t.formModel,"idcard_no",e)},expression:"formModel.idcard_no"}}),a("van-field",{attrs:{name:"手机号",label:"手机号",placeholder:"手机号",rules:[{required:!0,message:"请填写手机号"},{pattern:/^[1][0-9]{10}$/,message:"手机号格式不对"}]},model:{value:t.formModel.phone,callback:function(e){t.$set(t.formModel,"phone",e)},expression:"formModel.phone"}}),a("div",{staticClass:"add_submit"},[a("van-button",{staticClass:"btn_add_submit",attrs:{block:"",type:"info","native-type":"submit",disabled:t.stockZero}},[t._v("确定")])],1)],1)],1)]),a("van-popup",{model:{value:t.resultShow,callback:function(e){t.resultShow=e},expression:"resultShow"}},[a("div",{staticClass:"result"},[a("div",{staticClass:"result_title"},[t._v("已提交成功")]),a("van-row",{attrs:{type:"flex",justify:"center",align:"center"}},[a("div",{staticClass:"result_text"},[t._v("\n          我们的工作人员会及时通过电话联系您， 请保持手机畅通\n        ")])]),a("div",[a("van-button",{staticClass:"btn_primary result_btn",on:{click:function(){return t.resultShow=!1}}},[t._v("确定")])],1)],1)]),a("van-popup",{style:{height:"100%"},attrs:{closeable:"",position:"bottom"},model:{value:t.calendarShow,callback:function(e){t.calendarShow=e},expression:"calendarShow"}},[a("van-calendar",{attrs:{title:"日历",poppable:!1,"show-confirm":!1,formatter:t.calendarFormatter},on:{select:t.calendarSelect}})],1)],1)},n=[],i=(a("8e6e"),a("456d"),a("20d6"),a("ac6a"),a("4662"),a("28a2")),o=a("ade3"),r=(a("7f7f"),a("96cf"),a("1da1")),l=a("1e1d");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={data:function(){return{list:[],currentTab:0,flightInfo:{},currentItem:{},flightList:[],travellerList:[],flightListShow:!1,travelShow:!1,hotelShow:!1,resultShow:!1,calendarShow:!1,calendarSelectShow:!0,defaultTraveInfo:{username:"",ename:"",idcard_no:"",phone:""},formModel:{username:"",ename:"",idcard_no:"",phone:""},contactInfo:{username:"",ename:"",idcard_no:"",phone:""},hotelInfo:{},submiting:!1,schedule:0,startTime:"",endCity:"",startCity:"",price:0,hotel_price:0,hangid:0,hotel_id:0}},components:{TitleBar:l["default"]},computed:{hasStock:function(){try{return this.flightInfo.bookingStock>5}catch(t){return!0}},stockZero:function(){try{return this.flightInfo.bookingStock<=0}catch(t){return!1}}},created:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s,n,i,o,r,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this.$route.query,a=e.schedule,s=e.startTime,n=e.endCity,i=e.startCity,o=e.price,r=e.hotel_price,l=e.id,c=e.hotel_id,this.schedule=parseInt(a),this.startTime=s,this.startCity=i,this.endCity=n,this.price=parseInt(o),this.hotel_price=parseInt(r),this.hangid=l,this.hotel_id=c;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),beforeCreate:function(){document.querySelector("body").setAttribute("style","background:#ffffff")},beforeDestroy:function(){document.querySelector("body").setAttribute("style","")},beforeRouteEnter:function(t,e,a){document.querySelector("body").setAttribute("style","background:#ffffff"),a()},beforeRouteLeave:function(t,e,a){document.querySelector("body").setAttribute("style",""),a()},mounted:function(){window.addEventListener("scroll",this.handleScroll)},methods:{handleScroll:function(){var t=this;this.$nextTick((function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;console.log(e),t.calendarSelectShow=!(e>20)}))},handleTabClick:function(t,e){if("日历"!=e){this.currentItem=this.list[t];var a=this.list[t].item;this.flightList=a,a.length&&(this.flightInfo=a[0]),console.log(this.flightInfo)}else alert()},toggelFlight:function(){this.flightListShow=!0},handleFlightItemClick:function(t){this.flightInfo=t,this.flightListShow=!1},handleTravelAddClick:function(){this.formModel=f({},this.defaultTraveInfo),this.travelShow=!0},onClickLeft:function(){this.travelShow=!1,this.hotelShow=!1,this.flightListShow=!1},handleTravelSubmit:function(){this.travellerList.push(this.formModel),this.contactInfo.username||(this.contactInfo=f({},this.formModel)),this.travelShow=!1},handleSubmit:function(){var t=this,e=localStorage.getItem("wxUserInfo");if(e){var a=JSON.parse(e);this.$nextTick((function(){var e=t.$refs.contactForm;console.log(e),e.validate().then(Object(r["a"])(regeneratorRuntime.mark((function e(){var s,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={uid:a.id,id:t.hangid,username:t.contactInfo.username,idcard_no:t.contactInfo.idcard_no,phone:t.contactInfo.phone,user_info:t.travellerList,hotel_id:t.hotel_id},e.prev=1,t.submiting=!0,e.next=5,t.apis.home.createOrder(s);case 5:n=e.sent,0==n.code?(i=n.data.orderNo,t.toast("提交成功,3秒后跳转至支付页面"),setTimeout((function(){t.$router.push({path:"/pay",query:{orderNo:i}})}),3e3)):(t.submiting=!1,t.toast(n.msg)),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),t.submiting=!1,t.toast("提交失败");case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).catch((function(){}))}))}else this.toast("缺少用户授权信息，请先授权用户信息")},handleTravellerDel:function(t){this.travellerList.splice(t,1)},handleHotelDetailClick:function(){this.hotelShow=!0},sceneImg:function(t,e){Object(i["a"])({images:t,showIndex:!0,loop:!1,startPosition:e})},showCalendar:function(){this.calendarShow=!0},calendarFormatter:function(t){var e=this.moment(t.date).format("YYYY-MM-DD");return this.list.forEach((function(a){a.date==e&&(t.bottomInfo="¥ ".concat(a.mixPrice))})),t},calendarSelect:function(t){var e=this.moment(t).format("YYYY-MM-DD"),a=this.list.findIndex((function(t){return t.date==e}));if(a>=0){this.currentItem=this.list[a];var s=this.list[a].item;this.flightList=s,s.length&&(this.currentTab=a,this.flightInfo=s[0]),this.calendarShow=!1}}}},u=d,h=(a("6cd9"),a("2877")),v=Object(h["a"])(u,s,n,!1,null,"959434a2",null);e["default"]=v.exports},"6cd9":function(t,e,a){"use strict";a("2ed8")}}]);